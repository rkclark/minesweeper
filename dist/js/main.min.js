function rowUpdate(){numberOfRows=$(this).val()}function columnUpdate(){numberOfColumns=$(this).val()}function difficultyUpdate(){minesPercentage=$("input:radio[name=difficulty]:checked").val()}function generateGame(){mineCount=0,createRows(),$(".msrow").each(createCells),$(".msrow div").each(seedMines),$("#counter span").text(mineCount)}function createRows(){for(var e=1;e<=numberOfRows;e+=1)$($msrowDiv).addClass("msrow").appendTo("#game")}function createCells(e){e+=1;for(var o=numberOfRows+1-e,n=1;n<=numberOfColumns;n+=1)$($columnDiv).addClass("covered cell").attr("id",n+"_"+o).appendTo(this)}function seedMines(){var e=Math.random();e<minesPercentage?($(this).addClass("mine"),mineCount+=1):$(this).addClass("notmine")}function getMineProximity(e){for(var o=0,n=0;n<e.length;n+=1){var t=e[n];$("#"+t).hasClass("mine")&&(o+=1)}return o}function getNeighbourIds(e){for(var o=parseInt(e[0]),n=parseInt(e[1]),t=[{name:"topLeftNeighbour",xlocation:o-1,ylocation:n+1},{name:"topMiddleNeighbour",xlocation:o,ylocation:n+1},{name:"topRightNeighbour",xlocation:o+1,ylocation:n+1},{name:"leftNeighbour",xlocation:o-1,ylocation:n},{name:"rightNeighbour",xlocation:o+1,ylocation:n},{name:"bottomLeftNeighbour",xlocation:o-1,ylocation:n-1},{name:"bottomMiddleNeighbour",xlocation:o,ylocation:n-1},{name:"bottomRightNeighbour",xlocation:o+1,ylocation:n-1}],a=[],i=0;i<t.length;i+=1){var r=t[i].xlocation+"_"+t[i].ylocation;a.push(r)}return a}function gameOver(){$(".mine").removeClass("marked").addClass("detonated"),$("#msgbox").text("Detonation! You have lost. Press Reset to try again.")}function uncoverCells(){var e=$(this).attr("id"),o=e.split("_"),n=getNeighbourIds(o),t=getMineProximity.call(this,n);if(0===t){$(this).removeClass("covered").addClass("uncovered");for(var a=0;a<n.length;a+=1){var i=n[a];$("#"+i).hasClass("covered")&&$("#"+i).trigger("click")}}else $(this).removeClass("covered").addClass("uncovered").text(t)}function coveredClick(){$(this).hasClass("mine")?gameOver():(uncoverCells.call(this),$(".notmine.covered").length||(console.log("GAMEWON"),gameWon()))}function coveredRightClick(e){3==e.which&&($(this).hasClass("marked")?($(this).removeClass("marked"),mineCount+=1,$("#counter span").text(mineCount)):($(this).addClass("marked"),mineCount-=1,$("#counter span").text(mineCount)))}function gameWon(){$("#msgbox").text("Congratulations! Your awesomeness is confirmed. You win!"),$(".mine").removeClass("marked").addClass("revealed")}function resetGame(){$(".msrow").each(function(){$(this).remove()}),$("#msgbox").text(""),generateGame()}var numberOfColumns=20,numberOfRows=20,$msrowDiv="<div>&nbsp;</div>",$columnDiv="<div>&nbsp;</div>",minesPercentage=.15,mineCount=0;$("#vertical").keyup(rowUpdate).change(rowUpdate),$("#horizontal").keyup(columnUpdate).change(columnUpdate),$("input:radio[name=difficulty]").change(difficultyUpdate),$(document).ready(generateGame()),$("#game").on("click",".covered",coveredClick),$("#game").on("mousedown",".covered",coveredRightClick),$("#game").on("contextmenu",".covered",function(e){e.preventDefault()}),$("#reset, #generate").click(function(e){e.preventDefault(),resetGame()});