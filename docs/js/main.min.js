function difficultyUpdate(){minesPercentage=$("input:radio[name=difficulty]:checked").val()}function isTouchDevice(){return"ontouchstart"in document.documentElement}function calculateSize(){horiz=Math.floor(.8*$(window).width()/35),$("#horizontal").val(horiz),vert=Math.floor(.8*($(window).height()-160)/35),$("#vertical").val(vert)}function generateGame(){numberOfColumns=$("#horizontal").val(),numberOfRows=$("#vertical").val(),mineCount=0,createRows(),$(".msrow").each(createCells),$(".msrow div").each(seedMines),$("#counter").text(mineCount),status=""}function createRows(){for(var e=1;e<=numberOfRows;e+=1)$($msrowDiv).addClass("msrow row").appendTo("#game")}function createCells(e){e+=1;for(var t=numberOfRows+1-e,o=1;o<=numberOfColumns;o+=1)$($columnDiv).addClass("covered cell col-xs").attr("id",o+"_"+t).appendTo(this)}function seedMines(){var e=Math.random();e<minesPercentage?($(this).addClass("mine"),mineCount+=1):$(this).addClass("notmine")}function getMineProximity(e){for(var t=0,o=0;o<e.length;o+=1){var a=e[o];$("#"+a).hasClass("mine")&&(t+=1)}return t}function getNeighbourIds(e){for(var t=parseInt(e[0]),o=parseInt(e[1]),a=[{name:"topLeftNeighbour",xlocation:t-1,ylocation:o+1},{name:"topMiddleNeighbour",xlocation:t,ylocation:o+1},{name:"topRightNeighbour",xlocation:t+1,ylocation:o+1},{name:"leftNeighbour",xlocation:t-1,ylocation:o},{name:"rightNeighbour",xlocation:t+1,ylocation:o},{name:"bottomLeftNeighbour",xlocation:t-1,ylocation:o-1},{name:"bottomMiddleNeighbour",xlocation:t,ylocation:o-1},{name:"bottomRightNeighbour",xlocation:t+1,ylocation:o-1}],n=[],s=0;s<a.length;s+=1){var i=a[s].xlocation+"_"+a[s].ylocation;n.push(i)}return n}function gameOver(){status="lost",$(".notmine.marked").removeClass("marked").addClass("uncovered"),$(".mine").removeClass("marked").addClass("detonated").empty().append('<img class="img-fluid" src="img/mine.svg">'),$("#cover").show("slow"),$("#messages").empty().append('<p class="col-xs-12">Detonation!</p><p class="col-xs-12">I\'m afraid you\'ve lost.</p>'),$("#messagebutton").empty().text("Bummer!")}function uncoverCells(){var e=$(this).attr("id"),t=e.split("_"),o=getNeighbourIds(t),a=getMineProximity.call(this,o);if(0===a){$(this).removeClass("covered").addClass("uncovered");for(var n=0;n<o.length;n+=1){var s=o[n];$("#"+s).hasClass("covered")&&$("#"+s).trigger("click")}}else $(this).removeClass("covered").addClass("uncovered").append('<div class="cell-text-wrapper"><p class="cell-text">'+a+"</p></div>")}function coveredClick(){""!=status||($(this).hasClass("mine")?gameOver():($(this).hasClass("marked")&&removeMark($(this)),uncoverCells.call(this),$(".notmine.covered").length||(console.log("status is "+status),console.log("GAMEWON"),""==status&&gameWon())))}function coveredRightClick(e){3==e.which&&(""!=status||($(this).hasClass("marked")?removeMark($(this)):($(this).addClass("marked").append('<img class="img-fluid" src="img/mine.svg">'),mineCount-=1,$("#counter").text(mineCount))))}function coveredTaphold(){""!=status||($(this).hasClass("marked")?removeMark($(this)):($(this).addClass("marked").append('<img class="img-fluid" src="img/mine.svg">'),mineCount-=1,$("#counter").text(mineCount)))}function removeMark(e){e.removeClass("marked").empty(),mineCount+=1,$("#counter").text(mineCount)}function gameWon(){status="won",$("#cover").show("slow"),$("#messages").empty().append('<p class="col-xs-12">You won!</p><p class="col-xs-12">Your awesomeness is confirmed.</p>'),$("#messagebutton").empty().text("Hooray!"),$(".mine").removeClass("marked").addClass("revealed")}function resetGame(){$(".msrow").each(function(){$(this).remove()}),$("#msgbox").text(""),generateGame()}var numberOfColumns=0,numberOfRows=0,$msrowDiv="<div></div>",$columnDiv="<div></div>",minesPercentage=.15,mineCount=0,status="";$("input:radio[name=difficulty]").change(difficultyUpdate),$(document).ready(function(){calculateSize(),generateGame(),isTouchDevice()&&($("#cover").show("slow"),$("#messages").empty().append('<p class="col-xs-12">Tap to uncover each square, tap and hold to mark them as mines!</p>'),$("#messagebutton").empty().text("OK!"))}),$("#game").on("click",".covered",coveredClick),$("#game").on("mousedown",".covered",coveredRightClick),$("#game").on("taphold",".covered",coveredTaphold),$("#game").on("contextmenu",".covered",function(e){e.preventDefault()}),$("#game").on("contextmenu",function(e){e.preventDefault()}),$("#reset").click(function(e){e.preventDefault(),resetGame()}),$("#generate").click(function(e){e.preventDefault(),resetGame(),$("#settings-icon").click()}),$("#autosize").click(function(e){e.preventDefault(),calculateSize()}),$("#messagebutton").click(function(e){e.preventDefault(),$("#cover").hide("slow")}),$("#settings-icon").click(function(){$(this).toggleClass("rotate"),$("#settingscontainer").toggleClass("fade-out").toggleClass("slide-out")});